<% layout('/layouts/boilerplate') %>

<div class="container" style="margin-top: 100px;">
  <div class="d-flex justify-content-between align-items-center">
    <h2>Notifications</h2>
    <form action="/notifications/mark-all-read" method="POST">
      <button class="btn btn-sm btn-outline-primary">Mark all read</button>
    </form>
  </div>

  <div class="list-group mt-3">
    <% if (notifications.length === 0) { %>
      <div class="text-center text-muted py-5">No notifications yet</div>
    <% } %>

    <% notifications.forEach(n => { %>
      <div class="list-group-item d-flex justify-content-between align-items-start <% if (!n.read) { %> list-group-item-warning <% } %>">
        <div>
          <div><%= n.message %></div>
          <small class="text-muted"><%= new Date(n.createdAt).toLocaleString() %></small>
        </div>
        <div>
          <% if (!n.read) { %>
            <form action="/notifications/<%= n._id %>/read" method="POST" class="d-inline">
              <button class="btn btn-sm btn-primary">Mark read</button>
            </form>
          <% } %>
        </div>
      </div>
    <% }) %>
  </div>
</div>
