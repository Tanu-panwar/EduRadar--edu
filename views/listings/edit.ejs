<% layout("/layouts/boilerplate") %>
  <style>
    .form-control,
    .btn {
      border-radius: 10px;
    }

    .form-control {
      border-radius: 10px;
      border: 1.5px solid #ccc;
      box-shadow: none;
      padding: 0.4rem 0.4rem;
      font-size: 1rem;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .form-control:focus {
      border-color: #6c5ce7;
      box-shadow: 0 0 0 0.15rem rgba(108, 92, 231, 0.25);
      outline: none;
    }

    .form-label {
      font-weight: 500;
      margin-bottom: 0.3rem;
    }

    .btn-primary {
      background-color: #e6b631;
      border-color: #e6b631;
      font-weight: 500;
    }

    .btn-primary:hover {
      background-color: #e0a800;
    }

    .btn:focus,
    .btn-primary:focus,
    .btn-primary:active,
    .btn-primary:focus-visible {
      box-shadow: none !important;
      outline: none !important;
    }
  </style>


  <div class="container py-5 mt-5">
    <div class="text-center">
      <h2 class="mb-4">Edit Listing</h2>
    </div>

    <form class="needs-validation" novalidate action="/listings/<%= listing._id %>?_method=PUT" method="POST"
      enctype="multipart/form-data">

      <!-- Title -->
      <div class="mb-3">
        <label class="form-label">Business Title</label>
        <input type="text" class="form-control" name="listing[title]" value="<%= listing.title %>" required />
        <div class="valid-feedback">✅ Looks good!</div>
        <div class="invalid-feedback">Please provide a title.</div>
      </div>

      <!-- Business Name -->
      <div class="mb-3">
        <label class="form-label">Business Name</label>
        <input type="text" class="form-control" name="listing[name]" value="<%= listing.name %>" required />
        <div class="valid-feedback">✅ Looks good!</div>
        <div class="invalid-feedback">Please provide the name.</div>
      </div>

      <!-- Location -->
      <div class="mb-3">
        <label class="form-label">Location</label>
        <input type="text" class="form-control" name="listing[location]" value="<%= listing.location %>" required />
        <div class="valid-feedback">✅ Looks good!</div>
        <div class="invalid-feedback">Please provide a location.</div>
      </div>

      <!-- Category -->
      <div class="mb-3">
        <label class="form-label">Category</label>
        <select class="form-select" name="listing[category]" required>
          <option value="">Choose...</option>
          <option value="Stationery" <%=listing.category==='Stationery' ? 'selected' : '' %>>Stationery</option>
          <option value="Library" <%=listing.category==='Library' ? 'selected' : '' %>>Library</option>
          <option value="Cyber Cafe" <%=listing.category==='CyberCafe' ? 'selected' : '' %>>Cyber Cafe</option>
          <option value="Bookstore" <%=listing.category==='Bookstore' ? 'selected' : '' %>>Bookstore</option>
          <option value="Coaching" <%=listing.category==='Coaching' ? 'selected' : '' %>>Coaching</option>
        </select>
        <div class="valid-feedback">✅ Looks good!</div>
        <div class="invalid-feedback">Please select a category.</div>
      </div>

      <!-- Description -->
      <div class="mb-3">
        <label class="form-label">Description</label>
        <textarea class="form-control" name="listing[description]" rows="3"
          required><%= listing.description %></textarea>
        <div class="valid-feedback">✅ Looks good!</div>
        <div class="invalid-feedback">Please enter a short description.</div>
      </div>

      <div class="mb-3">
        Original Image <br />
        <img src="<%= originalImageUrl %>" />
      </div>

      <!-- Image -->
      <div class="mb-3">
        <label class="form-label">Upload New Image</label>
        <input type="file" class="form-control" name="listing[image]" />
      </div>

      <!-- Contact & Open Hours -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Contact</label>
          <input type="text" class="form-control" name="listing[contact]" value="<%= listing.contact %>" />
        </div>

        <div class="col-md-6 mb-3">
          <label class="form-label">Open Hours</label>
          <input type="text" class="form-control" name="listing[openHours]" value="<%= listing.openHours %>" />
        </div>
      </div>

      <!-- Alternate Contact -->
      <div class="mb-3">
        <label class="form-label">Alternate Contact</label>
        <input type="text" class="form-control" name="listing[alternateContact]"
          value="<%= listing.alternateContact %>" />
      </div>

      <!-- WhatsApp -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">WhatsApp Number</label>
          <input type="text" class="form-control" name="listing[whatsappNumber]"
            value="<%= listing.whatsappNumber %>" />
        </div>

        <!-- Email -->
        <div class="col-md-6 mb-3">
          <label class="form-label">Email</label>
          <input type="email" class="form-control" name="listing[email]" value="<%= listing.email %>" required />
          <div class="invalid-feedback">Please enter a valid email address.</div>
        </div>
      </div>

      <!-- Website -->
      <div class="mb-3">
        <label class="form-label">Website</label>
        <input type="url" class="form-control" name="listing[website]" value="<%= listing.website %>" />
      </div>

      <!-- Google Map Link -->
      <div class="mb-3">
        <label class="form-label">Google Map Link</label>
        <input type="url" class="form-control" name="listing[googleMapLink]" value="<%= listing.googleMapLink %>" />
      </div>

      <!-- Facebook -->
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Facebook Page</label>
          <input type="url" class="form-control" name="listing[facebookPage]" value="<%= listing.facebookPage %>" />
        </div>

        <!-- Instagram -->
        <div class="col-md-6 mb-3">
          <label class="form-label">Instagram Page</label>
          <input type="url" class="form-control" name="listing[instagramPage]" value="<%= listing.instagramPage %>" />
        </div>
      </div>


      <button type="submit" class="btn btn-primary d-block mx-auto px-4 mt-4 mb-0">Save Changes</button>

    </form>
  </div>